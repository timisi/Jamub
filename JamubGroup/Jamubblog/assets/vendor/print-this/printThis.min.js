(function(a){function c(f,g){if(!g){return}f.append(g.jquery?g.clone():g)}function b(f,h,i){var g=h.clone(i.formValues);if(i.formValues){d(h,g,"select, textarea")}if(i.removeScripts){g.find("script").remove()}if(i.printContainer){g.appendTo(f)}else{g.each(function(){a(this).children().appendTo(f)})}}function d(i,g,h){var f=i.find(h);g.find(h).each(function(j,k){a(k).val(f.eq(j).val())})}var e;a.fn.printThis=function(j){e=a.extend({},a.fn.printThis.defaults,j);var f=this instanceof jQuery?this:a(this);var l="printThis-"+(new Date()).getTime();if(window.location.hostname!==document.domain&&navigator.userAgent.match(/msie/i)){var i='javascript:document.write("<head><script>document.domain=\\"'+document.domain+'\\";</script></head><body></body>")';var k=document.createElement("iframe");k.name="printIframe";k.id=l;k.className="MSIE";document.body.appendChild(k);k.src=i}else{var g=a("<iframe id='"+l+"' name='printIframe' />");g.appendTo("body")}var h=a("#"+l);if(!e.debug){h.css({position:"absolute",width:"0px",height:"0px",left:"-600px",top:"-600px"})}setTimeout(function(){function s(u,w){var x,v;x=u.get(0);x=x.contentWindow||x.contentDocument||x;v=x.document||x.contentDocument||x;v.open();v.write(w);v.close()}if(e.doctypeString){s(h,e.doctypeString)}var o=h.contents(),p=o.find("head"),n=o.find("body"),m=a("base"),q;if(e.base===true&&m.length>0){q=m.attr("href")}else{if(typeof e.base==="string"){q=e.base}else{q=document.location.protocol+"//"+document.location.host}}p.append('<base href="'+q+'">');if(e.importCSS){a("link[rel=stylesheet]").each(function(){var u=a(this).attr("href");if(u){var v=a(this).attr("media")||"all";p.append("<link type='text/css' rel='stylesheet' href='"+u+"' media='"+v+"'>")}})}if(e.importStyle){a("style").each(function(){a(this).clone().appendTo(p)})}if(e.pageTitle){p.append("<title>"+e.pageTitle+"</title>")}if(e.loadCSS){if(a.isArray(e.loadCSS)){jQuery.each(e.loadCSS,function(u,v){p.append("<link type='text/css' rel='stylesheet' href='"+this+"'>")})}else{p.append("<link type='text/css' rel='stylesheet' href='"+e.loadCSS+"'>")}}var t=e.copyTagClasses;if(t){t=t===true?"bh":t;if(t.indexOf("b")!==-1){n.addClass(a("body")[0].className)}if(t.indexOf("h")!==-1){o.find("html").addClass(a("html")[0].className)}}c(n,e.header);if(e.canvas){var r=0;f.find("canvas").addBack("canvas").each(function(){a(this).attr("data-printthis",r++)})}b(n,f,e);if(e.canvas){n.find("canvas").each(function(){var v=a(this).data("printthis"),u=a('[data-printthis="'+v+'"]');this.getContext("2d").drawImage(u[0],0,0);u.removeData("printthis")})}if(e.removeInline){if(a.isFunction(a.removeAttr)){o.find("body *").removeAttr("style")}else{o.find("body *").attr("style","")}}c(n,e.footer);setTimeout(function(){if(h.hasClass("MSIE")){window.frames.printIframe.focus();p.append("<script>  window.print(); </script>")}else{if(document.queryCommandSupported("print")){h[0].contentWindow.document.execCommand("print",false,null)}else{h[0].contentWindow.focus();h[0].contentWindow.print()}}if(!e.debug){setTimeout(function(){h.remove()},1000)}},e.printDelay)},333)};a.fn.printThis.defaults={debug:false,importCSS:true,importStyle:false,printContainer:true,loadCSS:"",pageTitle:"",removeInline:false,printDelay:333,header:null,footer:null,formValues:true,canvas:false,base:false,doctypeString:"<!DOCTYPE html>",removeScripts:false,copyTagClasses:false}})(jQuery);